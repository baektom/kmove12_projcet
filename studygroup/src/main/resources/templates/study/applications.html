<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ì°¸ê°€ ì‹ ì²­ ê´€ë¦¬ - STUDY MATE</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .container { max-width: 1000px; margin: 40px auto; padding: 40px; }
        .page-title { font-size: 2rem; font-weight: bold; margin-bottom: 10px; color: #333; }
        .study-info { background-color: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
        .section { background-color: white; border-radius: 12px; padding: 30px; margin-bottom: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .section-title { font-size: 1.5rem; font-weight: bold; margin-bottom: 20px; color: #2b56f5; }
        .member-list { display: flex; flex-direction: column; gap: 20px; }
        .member-card { padding: 25px; background-color: #f8f9fa; border-radius: 12px; border: 2px solid #e9ecef; }
        .member-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; }
        .member-info { flex: 1; }
        .member-name { font-size: 1.2rem; font-weight: 600; margin-bottom: 8px; color: #333; }
        .member-detail { color: #666; font-size: 0.95rem; line-height: 1.6; }
        .application-message { background-color: white; padding: 20px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #2b56f5; }
        .message-label { font-weight: 600; color: #2b56f5; margin-bottom: 10px; font-size: 0.95rem; }
        .message-content { color: #333; line-height: 1.8; white-space: pre-wrap; }
        .button-group { display: flex; gap: 10px; }
        .btn { padding: 10px 20px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-approve { background-color: #28a745; color: white; }
        .btn-approve:hover { background-color: #218838; }
        .btn-reject { background-color: #dc3545; color: white; }
        .btn-reject:hover { background-color: #c82333; }
        .btn-back { background-color: #6c757d; color: white; text-decoration: none; display: inline-block; padding: 10px 25px; border-radius: 8px; font-weight: 600; }
        .btn-back:hover { background-color: #5a6268; }
        .empty-message { text-align: center; padding: 40px; color: #999; }
        .status-badge { display: inline-block; padding: 6px 14px; border-radius: 12px; font-size: 0.9rem; font-weight: 600; }
        .status-approved { background-color: #d4edda; color: #155724; }
        .approved-member-card { display: flex; justify-content: space-between; align-items: center; padding: 20px; background-color: #f8f9fa; border-radius: 8px; border: 2px solid #e9ecef; }
    </style>
</head>
<body>

<header th:replace="~{layout/header :: header}"></header>

<main class="container">
    <h1 class="page-title">ì°¸ê°€ ì‹ ì²­ ê´€ë¦¬</h1>

    <div class="study-info">
        <h3 th:text="${study.title}">ìŠ¤í„°ë”” ì œëª©</h3>
        <p style="color: #666; margin-top: 5px;">
            ì°¸ì—¬ì¸ì›: <strong th:text="${study.currentParticipants}">1</strong> /
            <span th:text="${study.maxParticipants}">5</span>
        </p>
    </div>

    <div class="section">
        <h2 class="section-title">â³ ëŒ€ê¸°ì¤‘ì¸ ì‹ ì²­ (<span th:text="${#lists.size(pendingMembers)}">0</span>ê±´)</h2>

        <div class="member-list" th:if="${!#lists.isEmpty(pendingMembers)}">
            <div class="member-card" th:each="member : ${pendingMembers}" th:if="${member != null}">
                <div class="member-header">
                    <div class="member-info">
                        <div class="member-name" th:text="${member.userName}">í™ê¸¸ë™</div>
                        <div class="member-detail">
                            ì´ë©”ì¼: <span th:text="${member.userEmail}">hong@example.com</span><br>
                            ì‹ ì²­ì¼: <span th:text="${member.appliedAt}">2024-01-01 12:00</span>
                        </div>
                    </div>
                </div>

                <div class="application-message">
                    <div class="message-label">ğŸ’¬ ì‹ ì²­ ì‚¬ìœ </div>
                    <div class="message-content" th:text="${member.applicationMessage}">
                        ì‹ ì²­ ì‚¬ìœ ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                    </div>
                </div>

                <div class="button-group">
                    <form th:action="@{/study/member/{mid}/approve(mid=${member.id})}" method="post" style="display:inline;">
                        <input type="hidden" name="studyId" th:value="${study.id}">
                        <button type="submit" class="btn btn-approve">âœ“ ìŠ¹ì¸</button>
                    </form>

                    <form th:action="@{/study/member/{mid}/reject(mid=${member.id})}" method="post" style="display:inline;">
                        <input type="hidden" name="studyId" th:value="${study.id}">
                        <button type="submit" class="btn btn-reject">âœ— ê±°ë¶€</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="empty-message" th:if="${#lists.isEmpty(pendingMembers)}">
            ëŒ€ê¸°ì¤‘ì¸ ì‹ ì²­ì´ ì—†ìŠµë‹ˆë‹¤.
        </div>
    </div>

    <div class="section">
        <h2 class="section-title">âœ… ìŠ¹ì¸ëœ ë©¤ë²„ (<span th:text="${#lists.size(approvedMembers)}">0</span>ëª…)</h2>

        <div class="member-list" th:if="${!#lists.isEmpty(approvedMembers)}">
            <div class="approved-member-card" th:each="member : ${approvedMembers}" th:if="${member != null}">
                <div class="member-info">
                    <div class="member-name" th:text="${member.userName}">í™ê¸¸ë™</div>
                    <div class="member-detail">
                        ì´ë©”ì¼: <span th:text="${member.userEmail}">hong@example.com</span><br>
                        ê°€ì…ì¼: <span th:text="${member.appliedAt}">2024-01-01 12:00</span>
                    </div>
                </div>
                <span class="status-badge status-approved" th:text="${member.status}">ìŠ¹ì¸ë¨</span>
            </div>
        </div>

        <div class="empty-message" th:if="${#lists.isEmpty(approvedMembers)}">
            ìŠ¹ì¸ëœ ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤.
        </div>
    </div>

    <div style="text-align: center; margin-top: 30px;">
        <a th:href="@{/study/{id}(id=${study.id})}" class="btn btn-back">ìŠ¤í„°ë””ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>
</main>

</body>
</html>